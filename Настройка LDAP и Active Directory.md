# Настройка LDAP и Active Directory

## Описание работы 
При включенной интеграции Пассворк проверяет логин и пароль пользователя в LDAP / AD. Если LDAP / AD позволяет подключиться, то Пассворк авторизует пользователя.
При этом в Пассворке так же будет создана локальная учетная запись.

При первом входе Пассворк увидит, что локальной учетной записи еще нет и перебросит пользователя на страницу регистрации.
На странице регистрации необходимо ввести логин и пароль от LDAP / AD аккаунта.

*Важно*

LDAP / AD не распространяется на владельца организации. Этот пользователь всегда входит под своей локальной учетной записью.
Это необходимо для того, чтобы в случае проблемы всегда была возможность зайти под администратором.

### 1. Найдите настройки LDAP в config.ini файле
Найдите `<passwork folder>/app/config/config.ini` файл и секцию `[ldap]`.

### 2. Настройка маски

Пассворк использует LDAP для авторизации пользователей. Когда пользователь вводит свой логин и пароль и кликает «Войти», Пассворк пытается подключиться к LDAP (используя метод bind) и передает логин и пароль пользователя. Если LDAP принимает запрос, то пользователь становится авторизованным в Пассворке
По умолчанию LDAP использует специальный формат строки (содержит логин, домен и другие данные) для авторизации, которая называется DN (Distinguished Names). Пользоваться такой строкой как логином неудобно. Для решения этой проблемы в Пассворке используется т.н. маска, которую вы можете найти в config.ini файле. Маска — это шаблон DN со специальным токеном <login>. Пассворк берет маску, заменяет <login> на логин пользователя и передает эту строку в LDAP.


### 3. Маска для Windows Active Directory
Допустим ваш Windows домен называется `MyCompany`. В обычной ситуации у вас есть встроенный пользователь `Administrator`. 
Поэтому вы можете ввести `MyCompany\Administrator` и его пароль при авторизации в Windows.

В этом случае вам необходимо прописать следующую маску
`mask = "MyCompany\<login>"`

Затем попытать зарегистрироваться (не авторизоваться) в Пассворке под `Administrator` (или любым другие логин принадлежащим вашему домену).
После этого вы можете входить и выходить под этой учетной записью

### 4. Маска для LDAP
LDAP DN выглядит так: `uid=login,ou=group,dc=domain` и зависит от настроек вашего LDAP сервера.

Попробуйте указать такую маску
`mask = "uid=<login>,ou=your-group,dc=your-domain"`
Вместо `your-domain` укажите название вашего домена, а вместо `your-group` — название группы.




